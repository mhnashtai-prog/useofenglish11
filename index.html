<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>USE OF ENGLISH — C1</title>
<style>
/* === BASIC GLOBAL STYLES === */
*{margin:0;padding:0;box-sizing:border-box;}
body{
  font-family:'Segoe UI',Tahoma,sans-serif;
  background:linear-gradient(135deg,#1e3c72,#2a5298);
  color:white;min-height:100vh;
}
.container{max-width:1200px;margin:auto;padding:20px;min-height:100vh;display:flex;flex-direction:column;}
.header h1{font-size:2.5rem;font-weight:300;letter-spacing:2px;}
.highlight{color:#4FC3F7;font-weight:600;}
.main-content{display:flex;gap:40px;flex:1;}
/* === MENU PANEL === */
.menu-panel{flex:1;max-width:500px;}
.menu-item{background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2);
  border-radius:16px;padding:30px;margin-bottom:20px;cursor:pointer;transition:0.3s;}
.menu-item:hover{background:rgba(255,255,255,0.15);transform:translateY(-5px);}
.menu-letter{display:inline-block;width:40px;height:40px;background:rgba(79,195,247,0.3);
  border-radius:50%;line-height:40px;text-align:center;margin-bottom:15px;border:2px solid rgba(79,195,247,0.5);}
.generate-more{background:rgba(255,193,7,0.1);border:1px solid rgba(255,193,7,0.3);
  border-radius:12px;padding:10px;margin-top:10px;color:#FFC107;font-size:0.85rem;cursor:pointer;}
/* === SCREENS === */
.exercise-screen,.results-screen{display:none;text-align:center;}
.progress-container{background:rgba(255,255,255,0.1);border-radius:10px;height:8px;margin:20px 0;}
.progress-bar{background:linear-gradient(90deg,#4FC3F7,#29B6F6);height:100%;width:0%;}
.question-container{background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2);
  border-radius:16px;padding:20px;text-align:left;}
.options{display:grid;gap:10px;margin-top:10px;}
.option{background:rgba(255,255,255,0.05);border:2px solid rgba(255,255,255,0.2);
  border-radius:12px;padding:10px;cursor:pointer;display:flex;align-items:center;}
.option.correct{background:rgba(76,175,80,0.2);border-color:#4CAF50;}
.option.incorrect{background:rgba(244,67,54,0.2);border-color:#f44336;}
.option-letter{width:25px;height:25px;background:rgba(255,255,255,0.2);border-radius:50%;
  margin-right:10px;text-align:center;line-height:25px;}
.input-field{background:rgba(255,255,255,0.1);border:2px solid rgba(255,255,255,0.3);
  border-radius:8px;padding:8px 12px;color:white;}
.base-word{background:rgba(79,195,247,0.2);border:1px solid #4FC3F7;border-radius:4px;padding:2px 6px;margin-left:5px;}
.btn{background:linear-gradient(45deg,#4FC3F7,#29B6F6);border:none;border-radius:20px;padding:8px 16px;cursor:pointer;color:white;}
.btn-secondary{background:rgba(255,255,255,0.1);border:2px solid rgba(255,255,255,0.3);}
.btn-generate{background:linear-gradient(45deg,#FFC107,#FF9800);color:#1e3c72;}
.answer-item.correct{border-left:4px solid #4CAF50;}
.answer-item.incorrect{border-left:4px solid #f44336;}
.answer-item{background:rgba(255,255,255,0.05);border-radius:6px;padding:10px;margin-bottom:6px;}
</style>
</head>
<body>
<div class="container">
<!-- MAIN MENU -->
<div id="mainMenu">
  <div class="header"><h1>USE OF ENGLISH — <span class="highlight">C1</span></h1></div>
  <div class="main-content">
    <div class="menu-panel">
      <div class="menu-item" onclick="startExercise('multipleChoice')">
        <div class="menu-letter">A</div><h3>Multiple Choice</h3><p>12 items</p>
      </div>
      <div class="menu-item" onclick="startExercise('gapFill')">
        <div class="menu-letter">B</div><h3>Open Cloze</h3><p>8 blanks</p>
      </div>
      <div class="menu-item" onclick="startExercise('wordFormation')">
        <div class="menu-letter">C</div><h3>Word Formation</h3><p>8 items</p>
      </div>
      <div class="menu-item" onclick="startExercise('sentenceTransformation')">
        <div class="menu-letter">D</div><h3>Sentence Transformation</h3><p>6 items</p>
      </div>
    </div>
  </div>
</div>
<!-- EXERCISE SCREEN -->
<div id="exerciseScreen" class="exercise-screen">
  <h2 id="exerciseTitle"></h2>
  <div class="progress-container"><div id="progressBar" class="progress-bar"></div></div>
  <div id="questionNumber"></div>
  <div id="questionContainer" class="question-container"></div>
  <div class="controls">
    <button class="btn-secondary btn" onclick="returnToMenu()">MENU</button>
    <button id="nextBtn" class="btn" onclick="nextQuestion()">NEXT</button>
  </div>
</div>
<!-- RESULTS SCREEN -->
<div id="resultsScreen" class="results-screen">
  <h2>Results</h2>
  <div id="finalScore" style="font-size:1.5rem;margin-bottom:10px;"></div>
  <div id="answerKey"></div>
</div>
</div>
<script>
const exerciseTemplates={
  multipleChoice:{title:"Multiple Choice",totalQuestions:12,type:"multipleChoice"},
  gapFill:{title:"Open Cloze",totalQuestions:8,type:"gapFill"},
  wordFormation:{title:"Word Formation",totalQuestions:8,type:"wordFormation"},
  sentenceTransformation:{title:"Sentence Transformation",totalQuestions:6,type:"sentenceTransformation"}
};
const exerciseGenerators={
  multipleChoice:{
    patterns:[
      {q:"The company's reputation was severely _____ by the scandal.",opts:["damaged","harmed","tarnished","spoiled"],c:2,e:"'tarnished' collocation."},
      {q:"Despite her _____ efforts, she still felt exhausted.",opts:["conscious","conscientious","concentrated","considerable"],c:1,e:"'conscientious' = diligent."},
      {q:"The new evidence _____ serious doubts.",opts:["cast","put","placed","threw"],c:0,e:"'cast doubts' idiom."},
      {q:"She has a _____ for languages.",opts:["talent","gift","flair","skill"],c:2,e:"'flair for' usage."},
      {q:"The findings are _____ with previous studies.",opts:["consistent","persistent","resistant","insistent"],c:0,e:"'consistent with'."},
      {q:"The hotel's _____ service impressed everyone.",opts:["impeccable","irreproachable","unquestionable","indisputable"],c:0,e:"'impeccable service' collocation."},
      {q:"His argument was so _____ that critics agreed.",opts:["compelling","compulsive","comprehensive","competitive"],c:0,e:"'compelling' = convincing."},
      {q:"The committee decided to _____ the meeting.",opts:["delay","postpone","defer","adjourn"],c:1,e:"'postpone the meeting' standard."},
      {q:"Her _____ knowledge amazed everyone.",opts:["extensive","intensive","expansive","expensive"],c:0,e:"'extensive knowledge'."},
      {q:"The new policy aims to _____ balance.",opts:["achieve","obtain","acquire","attain"],c:0,e:"'achieve balance'."},
      {q:"The documentary _____ light on the issue.",opts:["cast","shed","threw","put"],c:1,e:"'shed light' idiom."},
      {q:"Performance has been _____ declining.",opts:["gradually","eventually","progressively","consecutively"],c:2,e:"'progressively declining'."}
    ],
    generate(){return this.patterns;}
  },
  gapFill:{
    patterns:[
      {q:"Scientists have discovered..., _____ it has been known for centuries.",a:"although",e:"contrast conj."},
      {q:"The museum, _____ houses rare items, attracts many.",a:"which",e:"relative clause"},
      {q:"_____ the circumstances, we went ahead.",a:"despite",e:"preposition usage"},
      {q:"She should _____ finished by now.",a:"have",e:"modal perfect"},
      {q:"The more you train, _____ better you get.",a:"the",e:"comparative structure"},
      {q:"Not only did we win, _____ we broke records.",a:"but",e:"correlative conj."},
      {q:"_____ it not been for you, we'd have failed.",a:"had",e:"inversion conditional"},
      {q:"Despite _____ warned, they ignored advice.",a:"being",e:"passive gerund"}
    ],
    generate(){return this.patterns;}
  },
  wordFormation:{
    patterns:[
      {base:"able",sent:"The device is highly _____.",a:"adaptable"},
      {base:"doubt",sent:"It is _____ the best ever.",a:"undoubtedly"},
      {base:"rely",sent:"Leaders must be _____.",a:"reliable"},
      {base:"predict",sent:"The system is highly _____.",a:"predictable"},
      {base:"impress",sent:"She made a lasting _____.",a:"impression"},
      {base:"broad",sent:"He has a _____ knowledge.",a:"broad"},
      {base:"recall",sent:"I have a vague _____.",a:"recollection"},
      {base:"aware",sent:"They were not _____.",a:"aware"}
    ],
    generate(){return this.patterns;}
  },
  sentenceTransformation:{
    patterns:[
      {p:"I haven't seen her for three years. (last)",a:"was the last time I saw her"},
      {p:"He started piano five years ago. (for)",a:"for five years"},
      {p:"This is the most boring film. (as)",a:"as boring a film as this"},
      {p:"They argued for hours. (kept)",a:"kept arguing for hours"},
      {p:"You didn't need to buy food. (needn't)",a:"needn't have bought"},
      {p:"I'll help only if you try. (provided)",a:"provided you promise"}
    ],
    generate(){return this.patterns;}
  }
};

let currentExercise,currentQuestions,currentIndex=0,score=0,answerKey=[];

function startExercise(type){
  currentExercise=exerciseTemplates[type];
  currentQuestions=exerciseGenerators[type].generate();
  currentIndex=0;score=0;answerKey=[];
  document.getElementById("exerciseTitle").textContent=currentExercise.title;
  document.getElementById("mainMenu").style.display="none";
  document.getElementById("resultsScreen").style.display="none";
  document.getElementById("exerciseScreen").style.display="block";
  displayQuestion();
}
function displayQuestion(){
  const q=currentQuestions[currentIndex];
  document.getElementById("questionNumber").textContent=`Question ${currentIndex+1} of ${currentQuestions.length}`;
  document.getElementById("progressBar").style.width=(currentIndex/currentQuestions.length*100)+"%";
  document.getElementById("nextBtn").disabled=true;
  let html="";
  if(currentExercise.type==="multipleChoice"){
    html=`<div class='question'>${q.q}</div><div class='options'>`;
    q.opts.forEach((opt,i)=>{html+=`<div class='option' onclick='selectOption(${i})'><div class='option-letter'>${String.fromCharCode(65+i)}</div>${opt}</div>`});
    html+="</div>";
  } else if(currentExercise.type==="gapFill"){
    html=`<div class='question'>${q.q.replace("_____", "<input id='gapInput' class='input-field'/>")}</div>
    <button class='btn' onclick='checkGapFill()'>CHECK</button><div id='gapFeedback'></div>`;
  } else if(currentExercise.type==="wordFormation"){
    html=`<div class='question'>${q.sent} <span class='base-word'>${q.base}</span></div>
    <input id='wfInput' class='input-field'/><button class='btn' onclick='checkWF()'>CHECK</button><div id='wfFeedback'></div>`;
  } else {
    html=`<div class='question'>${q.p}</div><input id='stInput' class='input-field'/>
    <button class='btn' onclick='checkST()'>CHECK</button><div id='stFeedback'></div>`;
  }
  document.getElementById("questionContainer").innerHTML=html;
}
function selectOption(i){
  const q=currentQuestions[currentIndex];
  const correctIndex=q.c;
  document.querySelectorAll(".option").forEach((el,idx)=>{
    el.classList.remove("correct","incorrect");
    if(idx===correctIndex) el.classList.add("correct");
    else if(idx===i) el.classList.add("incorrect");
  });
  if(i===correctIndex) score++;
  answerKey.push({question:q.q,entered:q.opts[i],correct:q.opts[correctIndex],result:(i===correctIndex),explanation:q.e});
  document.getElementById("nextBtn").disabled=false;
}
function checkGapFill(){
  const ans=document.getElementById("gapInput").value.trim().toLowerCase();
  const q=currentQuestions[currentIndex];
  const ok=ans===q.a.toLowerCase();
  document.getElementById("gapFeedback").innerHTML=ok?"<span style='color:lime'>Correct!</span> "+q.e:"<span style='color:red'>Incorrect.</span> Correct: "+q.a;
  if(ok) score++;
  answerKey.push({question:q.q,entered:ans,correct:q.a,result:ok,explanation:q.e});
  document.getElementById("nextBtn").disabled=false;
}
function checkWF(){
  const ans=document.getElementById("wfInput").value.trim().toLowerCase();
  const q=currentQuestions[currentIndex];
  const ok=ans===q.a.toLowerCase();
  document.getElementById("wfFeedback").innerHTML=ok?"<span style='color:lime'>Correct!</span>":"<span style='color:red'>Incorrect.</span> Correct: "+q.a;
  if(ok) score++;
  answerKey.push({question:q.sent,entered:ans,correct:q.a,result:ok});
  document.getElementById("nextBtn").disabled=false;
}
function checkST(){
  const ans=document.getElementById("stInput").value.trim().toLowerCase();
  const q=currentQuestions[currentIndex];
  const ok=ans.includes(q.a.toLowerCase());
  document.getElementById("stFeedback").innerHTML=ok?"<span style='color:lime'>Correct!</span>":"<span style='color:red'>Incorrect.</span> Expected: "+q.a;
  if(ok) score++;
  answerKey.push({question:q.p,entered:ans,correct:q.a,result:ok});
  document.getElementById("nextBtn").disabled=false;
}
function nextQuestion(){
  currentIndex++;
  if(currentIndex<currentQuestions.length){displayQuestion();}
  else{showResults();}
}
function showResults(){
  document.getElementById("exerciseScreen").style.display="none";
  document.getElementById("resultsScreen").style.display="block";
  document.getElementById("finalScore").textContent=`Score: ${score} / ${currentQuestions.length}`;
  let rev="";
  answerKey.forEach((a,i)=>{
    rev+=`<div class='answer-item ${a.result?"correct":"incorrect"}'>
      <div><b>Q${i+1}:</b> ${a.question}</div>
      <div>Your answer: ${a.entered}</div>
      <div>Correct: ${a.correct}</div>
      ${a.explanation||""}
    </div>`;
  });
  rev+=`<div style="text-align:center;margin-top:10px;">
    <button class="btn-generate btn" onclick="generateNew(currentExercise.type)">GENERATE NEW SET</button>
  </div>`;
  document.getElementById("answerKey").innerHTML=rev;
}
function generateNew(type){startExercise(type);}
function returnToMenu(){
  document.getElementById("mainMenu").style.display="block";
  document.getElementById("exerciseScreen").style.display="none";
  document.getElementById("resultsScreen").style.display="none";
}
</script>
</body>
</html>
